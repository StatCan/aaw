


<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="User guide for the DAaaS Covid-19 Platform">
      
      
        <link rel="canonical" href="https://statcan.github.io/daaas/fr/3-Pipelines/Kubeflow-Pipelines/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.4.0">
    
    
      
        <title>Kubeflow Pipelines - Espace d'analyse avancée du COVID-19</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fe0cca5b.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a46bcfb3.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#vue-densemble" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://statcan.github.io/daaas/fr/" title="Espace d'analyse avancée du COVID-19" class="md-header-nav__button md-logo" aria-label="Espace d'analyse avancée du COVID-19">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Espace d'analyse avancée du COVID-19
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Kubeflow Pipelines
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/statcan/daaas/" title="Aller au dépôt" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    statcan/daaas
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://statcan.github.io/daaas/fr/" title="Espace d'analyse avancée du COVID-19" class="md-nav__button md-logo" aria-label="Espace d'analyse avancée du COVID-19">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Espace d'analyse avancée du COVID-19
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/statcan/daaas/" title="Aller au dépôt" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    statcan/daaas
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Démarrage" class="md-nav__link">
      Démarrage
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Analyse
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Analyse" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Analyse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Experiences/Kubeflow/" title="Kubeflow" class="md-nav__link">
      Kubeflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Experiences/Jupyter/" title="Jupyter" class="md-nav__link">
      Jupyter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Experiences/RStudio/" title="RStudio" class="md-nav__link">
      RStudio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Experiences/Bureau-virtuel/" title="Bureau-Virtuel" class="md-nav__link">
      Bureau-Virtuel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Experiences/MLflow/" title="MLflow" class="md-nav__link">
      MLflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Publication
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Publication" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Publication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-Publication/R-Shiny/" title="R Shiny" class="md-nav__link">
      R Shiny
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-Publication/Dash/" title="Dash" class="md-nav__link">
      Dash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-Publication/Datasette/" title="Datasette" class="md-nav__link">
      Datasette
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-Publication/PowerBI/" title="Power BI" class="md-nav__link">
      Power BI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-Publication/Sur-mesure/" title="Sur mesure" class="md-nav__link">
      Sur mesure
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Pipelines
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Pipelines" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Pipelines
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Kubeflow Pipelines
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Kubeflow Pipelines" class="md-nav__link md-nav__link--active">
      Kubeflow Pipelines
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vue-densemble" class="md-nav__link">
    Vue d'ensemble
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quest-ce-quun-pipeline-et-comment-fonctionne-t-il" class="md-nav__link">
    Qu'est-ce qu'un pipeline et comment fonctionne-t-il?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definir-et-executer-votre-premier-pipeline" class="md-nav__link">
    Définir et exécuter votre premier pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#composants-legers" class="md-nav__link">
    Composants légers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprendre-lordre-des-calculs" class="md-nav__link">
    Comprendre l'ordre des calculs
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../PaaS/" title="PaaS Integration" class="md-nav__link">
      PaaS Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Serving/" title="Model Serving" class="md-nav__link">
      Model Serving
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Collaboration/" title="Collaboration" class="md-nav__link">
      Collaboration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Stockage/" title="Stockage" class="md-nav__link">
      Stockage
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Aide/" title="Aide/Contactez-nous" class="md-nav__link">
      Aide/Contactez-nous
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vue-densemble" class="md-nav__link">
    Vue d'ensemble
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quest-ce-quun-pipeline-et-comment-fonctionne-t-il" class="md-nav__link">
    Qu'est-ce qu'un pipeline et comment fonctionne-t-il?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definir-et-executer-votre-premier-pipeline" class="md-nav__link">
    Définir et exécuter votre premier pipeline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#composants-legers" class="md-nav__link">
    Composants légers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comprendre-lordre-des-calculs" class="md-nav__link">
    Comprendre l'ordre des calculs
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/statcan/daaas/edit/master/docs/fr/3-Pipelines/Kubeflow-Pipelines.md" title="Editer cette page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                  <h1>Kubeflow Pipelines</h1>
                
                <h2 id="vue-densemble">Vue d'ensemble</h2>
<p>Kubeflow Pipelines est une plateforme de création de flux de production
d'apprentissage automatique pouvant être déployés dans un environnement
Kubernetes. Il permet de créer des pipelines qui encapsulent les flux de
production analytiques (transformation de données, modèles de formation,
construction d'éléments visuels, etc.). Ces pipelines peuvent être mis en
commun, réutilisés et programmés. Ils sont créés de façon à être exécutés avec
les calculs fournis par Kubernetes.</p>
<p>Dans le contexte de l'espace de travail en analytique avancée, vous pouvez
interagir avec les pipelines Kubeflow par l'entremise :</p>
<ul>
<li>de <a href="../../1-Experiences/Kubeflow/">l'interface utilisateur</a> de Kubeflow, où, à
  partir du menu Pipelines, vous pouvez télécharger des pipelines, visualiser
  les pipelines que vous possédez et leurs résultats, etc.</li>
</ul>
<ul>
<li>de la trousse <a href="https://www.kubeflow.org/docs/pipelines/sdk/sdk-overview/">SDK</a>
  en Python de Kubeflow Pipelines, accessible dans les serveurs de bloc-notes
  Jupyter, où vous pouvez définir vos composants et pipelines, les soumettre
  pour les exécuter immédiatement, ou même les enregistrer pour plus tard.</li>
</ul>
<!-- prettier-ignore -->
<details class="exemple"><summary>Des exemples supplémentaires dans les bloc-notes</summary><p>Des exemples plus exhaustifs de pipelines produits expressément pour cette
plateforme sont accessibles dans
<a href="https://github.com/StatCan/jupyter-notebooks">GitHub</a> (et dans chaque
serveur de bloc-notes à <code>/jupyter-notebooks</code>). Vous pouvez également
consulter des sources publiques.</p>
</details>
<p>Voyez
<a href="https://www.kubeflow.org/docs/pipelines/overview/pipelines-overview/">le documentation officiel de Kubeflow</a>
pour obtenir une explication générale détaillée de Kubeflow.</p>
<p><img alt="Un pipeline Kubeflow" src="../../images/kf-pipeline_with_result.png" /></p>
<h2 id="quest-ce-quun-pipeline-et-comment-fonctionne-t-il">Qu'est-ce qu'un pipeline et comment fonctionne-t-il?</h2>
<p>Dans Kubeflow Pipelines, un pipeline comprend un ou plusieurs composants de
pipeline enchaînés pour former un flux de production. Les composants sont comme
des fonctions que le pipeline connecte ensemble.</p>
<p>Le <em>pipeline</em> décrit l'ensemble du flux de production de ce que vous souhaitez
accomplir, tandis que les <em>composants de pipeline</em> décrivent chacune des étapes
distinctes de ce processus (comme le fait d'extraire des colonnes d'un stock de
données, de transformer des données ou d'entraîner un modèle). Chaque
<strong>composant</strong> doit être <strong>modulaire</strong> et idéalement <strong>réutilisable</strong>.</p>
<p>Essentiellement, chaque <em>composant</em> a :</p>
<ul>
<li>une application autonome, présentée sous forme d'image de menu fixe
  (https://docs.docker.com/get-started/), pour effectuer le travail proprement
  dit .le code dans l'image de menu fixe peut être une séquence de commandes en
  langage naturel, un script Python ou tout autre code pouvant être exécuté à
  partir d'un terminal Linux</li>
<li>une description de la manière dont Kubeflow Pipelines exécute le code
  (l'emplacement de l'image, les arguments de la ligne de commande qu'il
  accepte, les résultats qu'il produit), sous forme de fichier YAML.</li>
</ul>
<p>Un <em>pipeline</em> définit ensuite la logique de connexion des composants, par
exemple :</p>
<ol>
<li>Exécuter <code>ComposantA</code></li>
<li>transmettre le résultat du <code>ComposantA</code> au <code>ComposantB</code> et au <code>ComposantC</code></li>
<li>...</li>
</ol>
<!-- prettier-ignore -->
<div class="admonition example">
<p class="admonition-title">Exemple d'un pipeline</p>
<p>Voici un exemple :</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/python3</span>
<span class="n">dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Estimer Pi&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Estimer Pi au moyen d&#39;un modèle Map-Reduce&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">compute_pi</span><span class="p">():</span>
    <span class="c1"># Créer un &quot;exemple&quot; d&#39;opération pour chaque valeur de départ</span>
    <span class="c1"># transmise au pipeline</span>
    <span class="n">seeds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">sample_ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">sample_op</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">seeds</span><span class="p">]</span>

    <span class="c1"># Obtenir les résultats avant de les transmettre à deux pipelines</span>
    <span class="c1"># distincts. Les résultats sont extraits des fichiers</span>
    <span class="c1"># `output_file.json` et sont disponibles à partir des instances</span>
    <span class="c1"># `sample_op` par l&#39;entremise de l&#39;attribut `.outputs`.</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sample_ops</span><span class="p">]</span>

    <span class="n">_generate_plot_op</span> <span class="o">=</span> <span class="n">generate_plot_op</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
    <span class="n">_average_op</span> <span class="o">=</span> <span class="n">average_op</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Vous pouvez trouver le pipeline complet dans
<a href="https://github.com/StatCan/jupyter-notebooks">l'exemple <code>map-reduce-pipeline</code></a>.</p>
</div>
<h2 id="definir-et-executer-votre-premier-pipeline">Définir et exécuter votre premier pipeline</h2>
<p>Bien que les <em>pipelines</em> et les <em>composants</em> soient définis par des fichiers
YAML, la trousse
<a href="https://www.kubeflow.org/docs/pipelines/sdk/sdk-overview/">SDK</a> en Python vous
permet de les définir à partir du code Python. Voici un exemple de définition
d'un
<a href="https://github.com/StatCan/jupyter-notebooks/blob/master/kfp-basics/average_with_docker_components.ipynb">pipeline simple</a>
en utilisant la trousse SDK en Python.</p>
<p>L'objectif de notre pipeline est de calculer, au moyen de cinq nombres, les
valeurs suivantes :</p>
<ol>
<li>la moyenne des trois premiers nombres;</li>
<li>la moyenne des deux derniers nombres;</li>
<li>la moyenne des résultats de (1) et de (2).</li>
</ol>
<p>Pour ce faire, nous définissons un <em>pipeline</em> qui utilise notre <em>composant</em>
moyen pour effectuer les calculs.</p>
<p>Le composant moyen est défini par une image de menu fixe au moyen d'un script
Python qui :</p>
<ul>
<li>accepte un ou plusieurs nombres comme arguments de ligne de commande</li>
<li>renvoie la moyenne de ces nombres, enregistrée dans le fichier <code>out.txt</code> dans
  son conteneur.</li>
</ul>
<p>Pour indiquer à Kubeflow Pipelines comment utiliser cette image, nous
définissons notre <em>composant</em> moyen par l'entremise d'un <code>ContainerOp</code>, qui
indique à Kubeflow l'interface API de notre image. L'instance <code>ContainerOp</code>
définit l'emplacement de l'image du menu fixe, la façon de lui transmettre des
arguments et les résultats à extraire du conteneur. Pour utiliser réellement ces
<code>ContainerOp</code> dans notre pipeline, nous créons des fonctions de fabrique comme
<code>average_op</code> (car nous voudrons probablement plus d'un <em>composant</em> moyen).</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">dsl</span>

<span class="k">def</span> <span class="nf">average_op</span><span class="p">(</span>\<span class="o">*</span><span class="n">numbers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Fabrique de ContainerOp moyen</span>

<span class="sd">    Accepte un nombre arbitraire de nombres d&#39;entrée, en renvoyant un ContainerOp</span>
<span class="sd">    qui transmet ces nombres à l&#39;image du menu fixe sous-jacent pour faire la</span>
<span class="sd">    moyenne</span>

<span class="sd">    Renvoie le résultat recueilli à partir du fichier ./out.txt à l&#39;intérieur du</span>
<span class="sd">    conteneur</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Validation d&#39;entrée</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Doit préciser au moins un nombre à partir duquel calculer la moyenne&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dsl</span><span class="o">.</span><span class="n">ContainerOp</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;averge&quot;</span><span class="p">,</span> <span class="c1"># Élément affiché dans la visionneuse de pipeline</span>
        <span class="n">image</span><span class="o">=</span><span class="s2">&quot;k8scc01covidacr.azurecr.io/kfp-components/average:v1&quot;</span><span class="p">,</span> <span class="c1"># L&#39;image</span>
        <span class="n">exécutée</span> <span class="n">par</span> <span class="n">Kubeflow</span> <span class="n">Pipelines</span> <span class="n">pour</span> <span class="n">faire</span> <span class="n">le</span> <span class="n">travail</span> <span class="n">arguments</span><span class="o">=</span><span class="n">numbers</span><span class="p">,</span>
        <span class="c1">#transmet chaque nombre comme un argument de ligne de commande (chaîne) distinct</span>
        <span class="c1"># Le script à l&#39;intérieur du conteneur enregistre le résultat (sous forme de chaîne de caractères) dans le fichier out.txt, que</span>
        <span class="c1"># Kubeflow Pipelines lit pour nous et récupère sous forme de chaîne.</span>
        <span class="n">file_outputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="s1">&#39;./out.txt&#39;</span><span class="p">},</span>
    <span class="p">)</span>
</code></pre></div>

<p>Nous définissons notre pipeline comme une fonction Python qui utilise les
fabriques de <code>ComponentOp</code> ci-dessus, décorées par l'élément décoratif
<code>@dsl.pipeline</code>. Notre pipeline utilise notre composant <em>moyen</em> en lui
transmettant des nombres. Puis, nous utilisons les résultats <em>moyens</em> en les
transmettant à des fonctions plus tard par l'accès à <code>avg\_\*.output</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="nd">@dsl</span><span class="o">.</span><span class="n">pipeline</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nom de mon pipeline&quot;</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">my_pipeline</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calcul de moyenne de pipeline, qui accepte cinq nombres et effectue quelques calculs de moyenne sur ceux-ci</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Calculer les moyennes pour deux groupes</span>

    <span class="n">avg_1</span> <span class="o">=</span> <span class="n">average_op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="n">avg_2</span> <span class="o">=</span> <span class="n">average_op</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

    <span class="c1"># Utiliser les résultats de \_1 et de \_2 pour calculer une moyenne globale</span>

    <span class="n">average_result_overall</span> <span class="o">=</span> <span class="n">average_op</span><span class="p">(</span><span class="n">avg_1</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">avg_2</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
</code></pre></div>

<p>Enfin, nous enregistrons une définition YAML de notre pipeline pour la
transmettre plus tard à Kubeflow Pipelines. Ce fichier YAML décrit à Kubeflow
Pipelines exactement comment exécuter notre pipeline. Décompressez-le et voyez
par vous-même!</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">kfp</span> <span class="kn">import</span> <span class="n">compiler</span>
<span class="n">pipeline_yaml</span> <span class="o">=</span> <span class="s1">&#39;pipeline.yaml.zip&#39;</span>
<span class="n">compiler</span><span class="o">.</span><span class="n">Compiler</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">my_pipeline</span><span class="p">,</span>
     <span class="n">pipeline_yaml</span>
<span class="p">)</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Définition de pipeline exportée vers </span><span class="si">{</span><span class="n">pipeline_yaml</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<!-- prettier-ignore -->
<p>??? avertissement "Kubeflow Pipelines est une bête paresseuse".
    Il est utile de garder à l'esprit le calcul qui se produit lorsque vous
    exécutez ce code Python par rapport à ce qui se passe lorsque vous soumettez
    le pipeline à Kubeflow Pipelines. Bien que tout semble se produire
    instantanément, essayez d'ajouter <code>print(avg_1.output)</code> au pipeline
    ci-dessus et voyez ce qui se passe lorsque vous compilez votre pipeline. La
    trousse SDK en Python que nous utilisons sert à créer des pipelines, et non
    à les exécuter, de sorte que les résultats des composants ne seront jamais
    disponibles lorsque vous exécuterez ce code Python. Ce point est abordé plus
    en détail plus loin, dans la section <em>Comprendre l'ordre des calculs</em>.</p>
<p>Pour exécuter notre pipeline, nous définissons une expérience :</p>
<div class="codehilite"><pre><span></span><code><span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;calcul de moyenne de pipeline&quot;</span>

<span class="kn">import</span> <span class="nn">kfp</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">kfp</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span>

<span class="n">pl_params</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span> <span class="p">}</span>
</code></pre></div>

<p>Voici ce qui peut être observé dans
<a href="../../1-Experiences/Kubeflow/">l'interface utilisateur</a> de Kubeflow Pipelines :</p>
<p><img alt="Expérience Kubeflow Pipelines" src="../../images/kfp_experiment.png" /></p>
<p>Ensuite, nous exécutons une instance de notre pipeline en utilisant les
arguments souhaités :</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="n">run</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">run_pipeline</span><span class="p">(</span>
    <span class="n">exp</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="c1"># Exécuter dans l&#39;expérience ci-dessus</span>
    <span class="n">experiment_name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">-%H%M%S&quot;</span><span class="p">),</span> <span class="c1"># Donner un nom et une</span>
    <span class="n">heure</span> <span class="n">système</span> <span class="n">à</span> <span class="n">notre</span> <span class="n">tâche</span> <span class="n">unique</span> <span class="n">pipeline_yaml</span><span class="p">,</span> <span class="c1"># Transmettre le .yaml.zip que</span>
    <span class="n">nous</span> <span class="n">avons</span> <span class="n">créé</span> <span class="n">ci</span><span class="o">-</span><span class="n">dessus</span><span class="o">.</span> <span class="n">Il</span> <span class="n">définit</span> <span class="n">le</span> <span class="n">pipeline</span> <span class="n">params</span><span class="o">=</span><span class="n">pl_params</span> <span class="c1"># Transmettre</span>
    <span class="n">les</span> <span class="n">paramètres</span> <span class="n">en</span> <span class="n">fonction</span> <span class="n">desquels</span> <span class="n">nous</span> <span class="n">souhaitons</span> <span class="n">exécuter</span> <span class="n">le</span> <span class="n">pipeline</span>
<span class="p">)</span>
</code></pre></div>

<p>Voici ce que l'on peut également voir dans l'interface utilisateur :</p>
<p><img alt="Expérience Kubeflow Pipelines" src="../../images/kfp_experiment.png" /></p>
<p>Plus tard, lorsque nous souhaiterons réutiliser le pipeline, nous pourrons
transmettre différents arguments et tout recommencer (et même le réutiliser à
partir de l'interface utilisateur de Kubeflow). Pour mieux comprendre cet
exemple, ouvrez-le dans Kubeflow et essayez-le vous-même.</p>
<h2 id="composants-legers">Composants légers</h2>
<p>En construction, malheureusement!</p>
<h2 id="comprendre-lordre-des-calculs">Comprendre l'ordre des calculs</h2>
<p>En construction, malheureusement!</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../2-Publication/Sur-mesure/" title="Sur mesure" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Précédent
                </span>
                Sur mesure
              </div>
            </div>
          </a>
        
        
          <a href="../PaaS/" title="PaaS Integration" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Suivant
                </span>
                PaaS Integration
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Statistics Canada
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/statcan/daaas" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://statcan-eaa.slack.com" target="_blank" rel="noopener" title="statcan-eaa.slack.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.b39636ac.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copier dans le presse-papier", "clipboard.copied": "Copi\u00e9 dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.a68abb33.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>